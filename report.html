<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: sans-serif; background: #f8fafc; padding: 30px; }
    .card { background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); overflow: hidden; max-width: 800px; margin: auto; }
    .head { background: #1e293b; color: white; padding: 20px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #f1f5f9; font-size: 12px; color: #64748b; }
  </style>
</head>
<body>
  <div class="card">
    <div class="head"><h2 id="n">--</h2><small id="t">--</small></div>
    <table>
      <thead><tr><th>Date</th><th>Loco</th><th>Section</th><th>Remarks</th></tr></thead>
      <tbody id="b"></tbody>
    </table>
  </div>
  <script>
    const API = "https://script.google.com/macros/s/AKfycbxg3mEv6z_2KS4gPkUuVlQGDWZx214Mb4haDkCc7z0YXfPcJXIQNRQ53p7saPM4O3elzw/exec";
    const p = new URLSearchParams(window.location.search);
    document.getElementById('n').innerText = p.get('name');
    document.getElementById('t').innerText = p.get('type') + " Monthly Record";
    async function load() {
      const r = await fetch(`${API}?getReport=true&name=${encodeURIComponent(p.get('name'))}&type=${p.get('type')}`);
      const d = await r.json();
      document.getElementById('b').innerHTML = d.map(r => `<tr><td>${r.date}</td><td><b>${r.loco}</b></td><td>${r.section}</td><td>${r.remark}</td></tr>`).join('');
    }
    load();
  </script>
</body>
</html>
